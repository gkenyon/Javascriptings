<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <title>lenticule</title>
    <style type="text/css">
        html, body { height:100%; margin:0; }
        body { background:#000; font:14px/1 helvetica,arial,freesans,sans-serif; }
        .lenticule { height:100%; margin:0 auto 3em; position:relative; width:100%; }
        .lenticule img { max-height:100%; max-width:100%; margin:auto; position:absolute; bottom:0; left:0; right:0; top:0; }
        .lenticule img:nth-child(1) { padding:12% 1% 0 0; }
        .lenticule img:nth-child(3) { max-width:initial; max-height:initial; padding:20% 0 0; height:176%; width:auto; }
        .lenticule img:nth-child(4) { padding:0 0 3% 2%; }
    </style>	
</head>

<body>
<!--
<p class="lenticule" id="liam"></p>
<script type="text/javascript">(function() {var l=document.getElementById('liam'); for( i=1; i<=171; ++i ){ l.innerHTML += '<img src="img/liam_st_paul/pure_'+ (i<10?'00':(i<100?'0':''))+i +'.jpg" alt="">' }})();</script>
-->
<!--
<script type="text/javascript">(function() {var l=document.getElementById('liam'); for( i=1; i<=12; ++i ){ l.innerHTML += '<img src="img/lenticular/hand/01/'+ (i<10?'0':'')+i +'.jpg" alt="">' }})();</script>
<script type="text/javascript">(function() {var l=document.getElementById('liam'); for( i=1; i<=170; ++i ){ l.innerHTML += '<img src="img/liam_st_paul/blend_'+ (i<10?'00':(i<100?'0':''))+i +'.jpg" alt="">' }})();</script>
<p class="lenticule"><img src="img/liam_st_paul/blend_078c.jpg" alt=""><img src="img/liam_st_paul/blend_081c.jpg" alt=""><img src="img/liam_st_paul/blend_095c.jpg" alt=""><img src="img/liam_st_paul/blend_105c.jpg" alt=""><img src="img/liam_st_paul/blend_109c.jpg" alt=""><img src="img/liam_st_paul/blend_110c.jpg" alt=""><img src="img/liam_st_paul/blend_111c.jpg" alt=""><img src="img/liam_st_paul/blend_116c.jpg" alt=""><img src="img/liam_st_paul/blend_117c.jpg" alt=""><img src="img/liam_st_paul/blend_118c.jpg" alt=""><img src="img/liam_st_paul/blend_123c.jpg" alt=""><img src="img/liam_st_paul/blend_125c.jpg" alt=""><img src="img/liam_st_paul/blend_126c.jpg" alt=""><img src="img/liam_st_paul/blend_127c.jpg" alt=""><img src="img/liam_st_paul/blend_135c.jpg" alt=""><img src="img/liam_st_paul/blend_152c.jpg" alt=""><img src="img/liam_st_paul/blend_162c.jpg" alt=""><img src="img/liam_st_paul/blend_168c.jpg" alt=""></p>
<p class="lenticule"><img src="img/liam_st_paul/pure_002.jpg" alt=""><img src="img/liam_st_paul/pure_003.jpg" alt=""><img src="img/liam_st_paul/pure_032.jpg" alt=""><img src="img/liam_st_paul/pure_036.jpg" alt=""><img src="img/liam_st_paul/pure_037.jpg" alt=""><img src="img/liam_st_paul/pure_070.jpg" alt=""><img src="img/liam_st_paul/pure_071.jpg" alt=""><img src="img/liam_st_paul/pure_075.jpg" alt=""><img src="img/liam_st_paul/pure_079.jpg" alt=""><img src="img/liam_st_paul/pure_096.jpg" alt=""><img src="img/liam_st_paul/pure_117.jpg" alt=""><img src="img/liam_st_paul/pure_118.jpg" alt=""><img src="img/liam_st_paul/pure_125.jpg" alt=""><img src="img/liam_st_paul/pure_126.jpg" alt=""><img src="img/liam_st_paul/pure_127.jpg" alt=""><img src="img/liam_st_paul/pure_135.jpg" alt=""><img src="img/liam_st_paul/pure_138.jpg" alt=""><img src="img/liam_st_paul/pure_151.jpg" alt=""><img src="img/liam_st_paul/pure_152.jpg" alt=""><img src="img/liam_st_paul/pure_163.jpg" alt=""><img src="img/liam_st_paul/pure_169.jpg" alt=""></p>
-->
<!--
<p class="lenticule"><img src="img/lenticular/VAM_1.jpg" alt=""><img src="img/lenticular/VAM_2.jpg" alt=""><img src="img/lenticular/VAM_3.jpg" alt=""><img src="img/lenticular/VAM_4.jpg" alt=""><img src="img/lenticular/VAM_5.jpg" alt=""></p>
<p class="lenticule"><img src="img/lenticular/VAM_head_2.1.jpg" alt=""><img src="img/lenticular/VAM_head_2.2.jpg" alt=""><img src="img/lenticular/VAM_head_2.3.jpg" alt=""><img src="img/lenticular/VAM_head_2.4.jpg" alt=""><img src="img/lenticular/VAM_head_2.5.jpg" alt=""><img src="img/lenticular/VAM_head_2.6.jpg" alt=""><img src="img/lenticular/VAM_head_2.7.jpg" alt=""><img src="img/lenticular/VAM_head_2.8.jpg" alt=""><img src="img/lenticular/VAM_head_2.9.jpg" alt=""></p>
<p class="lenticule"><img src="img/lenticular/VAM_thing_1.1.jpg" alt=""><img src="img/lenticular/VAM_thing_1.2.jpg" alt=""><img src="img/lenticular/VAM_thing_1.3.jpg" alt=""><img src="img/lenticular/VAM_thing_1.4.jpg" alt=""></p>
<p class="lenticule"><img src="img/lenticular/gnome-1.jpg" alt=""><img src="img/lenticular/gnome-2.jpg" alt=""><img src="img/lenticular/gnome-3.jpg" alt=""><img src="img/lenticular/gnome-4.jpg" alt=""><img src="img/lenticular/gnome-5.jpg" alt=""><img src="img/lenticular/gnome-6.jpg" alt=""><img src="img/lenticular/gnome-7.jpg" alt=""><img src="img/lenticular/gnome-8.jpg" alt=""></p>
<p class="lenticule"><img src="img/lenticular/birdbath-01.jpg" alt=""><img src="img/lenticular/birdbath-02.jpg" alt=""><img src="img/lenticular/birdbath-03.jpg" alt=""><img src="img/lenticular/birdbath-04.jpg" alt=""><img src="img/lenticular/birdbath-05.jpg" alt=""><img src="img/lenticular/birdbath-06.jpg" alt=""><img src="img/lenticular/birdbath-07.jpg" alt=""><img src="img/lenticular/birdbath-08.jpg" alt=""><img src="img/lenticular/birdbath-09.jpg" alt=""><img src="img/lenticular/birdbath-10.jpg" alt=""><img src="img/lenticular/birdbath-11.jpg" alt=""><img src="img/lenticular/birdbath-12.jpg" alt=""><img src="img/lenticular/birdbath-13.jpg" alt=""></p>
-->
<!--
<p class="lenticule"><img src="img/lenticular/constable.1.jpg" alt=""><img src="img/lenticular/constable.2.jpg" alt=""></p>
-->
<!--
<p class="lenticule"><img src="https://framemark.vam.ac.uk/demo/constable/2006AG5739/300,560,1500,2000/full/90/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/constable/2006AN8022/full/2000,1500/0/default.jpg" alt=""></p>
-->
<p class="lenticule"><img src="https://framemark.vam.ac.uk/demo/raphael/RC912749/full/full/!0/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/raphael/2006AN5938/full/full/!0/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/raphael/INV43867/full/full/0/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/raphael/2010EJ0404/full/full/0/default.jpg" alt=""></p>
<!--
<p class="lenticule"><img src="https://framemark.vam.ac.uk/demo/constable/2010EF0301/full/full/0/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/constable/2010EG9859/full/full/0/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/constable/2010EH2616/full/full/0/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/constable/2010EH2617/full/full/0/default.jpg" alt=""><img src="https://framemark.vam.ac.uk/demo/constable/N1207/full/full/0/default.jpg" alt=""></p>
-->

<script type="text/javascript">
Number.prototype.mod = function(n) { return ((this%n)+n)%n; }
function addHandler(el,evt,fn){ if( el.addEventListener ){ el.addEventListener(evt,fn,false); }else if( el.attachEvent ){ el.attachEvent('on'+evt,fn); } }
function getComputed(el,style){ if(window.getComputedStyle){ var y=document.defaultView.getComputedStyle(el,null).getPropertyValue(style); }else if(el.currentStyle){ if( style=='width' ){ y=el.getBoundingClientRect().right-el.getBoundingClientRect().left }else if( style=='height' ){ y=el.getBoundingClientRect().bottom-el.getBoundingClientRect().top }else{ var y=el.currentStyle[style] } } return parseFloat(y); }
function getPgOffset(el){ var o=[0,0]; if( el.offsetParent ){ do{ o=[o[0]+el.offsetLeft,o[1]+el.offsetTop]; }while( el=el.offsetParent ) } return [o[0]+document.body.scrollLeft,o[1]+document.body.scrollTop]; } 
function getXY(e){ var xy=[]; if( e.touches && e.touches.length ){ if( e.touches.length>1 ){ xy[0] = (e.touches[0].pageX+e.touches[0].pageX)/2; xy[1] = (e.touches[0].pageY+e.touches[0].pageY)/2;}else{ xy[0] = e.touches[0].pageX; xy[1] = e.touches[0].pageY; } }else{ xy[0] = e.pageX; xy[1] = e.pageY; } return xy; }
var lenticule = {
    el:null, xy0:null, xyT:null, id:0,
    size: function(el){
        el.wh = [getComputed(el,'width'), getComputed(el,'height')];
    },
    init: function(el, opt){
        var i;
        if( typeof el==='string' ){ el = document.getElementById(el); } if( !el ){ return; }
        if( !opt ) var opt = {};
        el.val = !!opt.val? opt.val : 0; 
        el.min = !!opt.min? opt.min : 0; 
        el.max = !!opt.max? opt.max : 1;
        el.rng = el.max-el.min;
        el.loop = !!opt.loop? opt.loop : 0;
        if( !el.cloned && el.loop ){ for( i=el.childNodes.length-2; i>=0; --i){ el.appendChild(el.childNodes[i].cloneNode(true)); } el.cloned=1; }
        if( !el.styled ){ el.appendChild(document.createElement('style')); el.styled=1; }
        if( !el.id ){ el.id = el.className+(++lenticule.id); }
        if( !el.load ){ for( i=0; i<=el.childNodes.length-1; ++i){ el.childNodes[i].onload=function(){this.style.opacity=0}; } el.load=1; }
        lenticule.size(el);
        el.arcs = el.childNodes.length-1;
        el.xy = [getComputed(el,'left'), getComputed(el,'top')];
        if( typeof(opt.slide)==='function' ){ el.slide = opt.slide; }
        if( typeof(opt.stop)==='function' ){ el.stop = opt.stop; }
        if( !el.move ){
            el.onmousedown = lenticule.touch;
            el.ontouchstart = lenticule.touch;
            el.move = function(xy){
                var vis;
                this.val = this.min+(xy[0]/this.wh[0]*(this.rng));
                this.val = this.val.mod(this.rng);
                vis = 1 + Math.ceil(this.val*this.arcs);
                this.querySelector('style').innerHTML = '#'+el.id+' :nth-child('+(vis-1)+'){opacity:1!important} #'+el.id+' :nth-child('+vis+'){opacity:'+(this.val%(1/this.arcs))*this.arcs+'!important}';
                this.xy = [xy[0],xy[1]];
            };
        }
    },
    touch: function(e){
        e = e || window.event;
        if( e.type==='touchstart' && e.touches && e.touches.length>2 ){ return; }
        lenticule.el = this;
        lenticule.xy0 = lenticule.el.xy;
        lenticule.xyT = getXY(e);
        lenticule.el.min = lenticule.el.val-(lenticule.xyT[0]/lenticule.el.wh[0]*(lenticule.el.max-lenticule.el.min));
        lenticule.el.max = lenticule.el.min+lenticule.el.rng;
        if( e.type==='touchstart' ){
            this.ontouchmove = lenticule.drag;
            this.onmousedown = null;
            this.ontouchend = function(){
                this.ontouchmove = null;
                this.ontouchend = null;
                lenticule.release();
            };
        }else{
            document.onmousemove = lenticule.drag;
            document.onmouseup = function(){
                document.onmousemove = null;
                document.onmouseup = null;
                lenticule.release();
            };
        }
        return false;
    },
    drag: function(e){
        e = e || window.event;
        if( e.preventDefault ){ e.preventDefault(); }else{ e.returnValue=false; }
        var xyE = getXY(e),
            xy = [lenticule.xy0[0]+xyE[0]-lenticule.xyT[0], lenticule.xy0[1]+xyE[1]-lenticule.xyT[1]];
        lenticule.el.move(xy);
        if( !!lenticule.el.slide ){ lenticule.el.slide.call(this); }
        return false;
    },
    release: function(){
        if( !!lenticule.el.stop ){ lenticule.el.stop.call(this); }
        lenticule.el = null;
    }
};

var i, j, els = document.querySelectorAll('.lenticule'), myWH, len, img, c;
for( i=0; i<els.length; ++i ){
    len = els[i];
    c = len.childNodes.length;
    for( j=0; j<c; ++j ){
        img = len.childNodes[j];
        if( j===0 ){
            lenticule.init(len, {'loop':0});
        };
        //~ img.onload = function(){
            //~ myWH = [getComputed(this, 'width'), getComputed(this, 'height')];
            //~ this.style.left = ((len.wh[0] - myWH[0]) / 2) + 'px';
            //~ this.style.top = ((len.wh[1] - myWH[1]) / 2) + 'px';
        //~ };
    }
}
addHandler(window,'resize',function(){
    for( i=0; i<els.length; ++i ){
        lenticule.size(els[i]);
    }
});
if( !!window.DeviceOrientationEvent ){
    addHandler(window,'deviceorientation',function(e){
        if( !lenticule.el ){
            for( i=0; i<els.length; ++i ){
                if( !!els[i].wh ){
                    lenticule.el = els[i];
                    xy = [(e.gamma/45)*lenticule.el.wh[0], lenticule.el.xy[1]];
                    lenticule.el.move(xy);
                    lenticule.el = null;
                }
            }
        }
    });
}
</script>
</body>
</html>
