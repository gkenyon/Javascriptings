<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
    </head>
    
    <style type="text/css">
        body { background:#666; margin:2em; }
        canvas { background:#ddd; border:1px solid #000; border-radius:300px; display:block; margin:0 auto; }
    </style>
    
    <body>
        <canvas id="cnv" width="600" height="600"></canvas>
    </body>
    
    <script type="text/javascript">
        
        var cnv = document.getElementById('cnv'),
            ctx = cnv.getContext('2d'),
            s = 4, //scaler
            pspctvX = 740,
            pspctvY = 740,
            x0 = parseInt(cnv.getAttribute('width'))/2,
            y0 = parseInt(cnv.getAttribute('height'))/2,
            t;     
            
        function Cube(x, y, z) {
            this.obj = [ [], [], [], [], [], [], [], [], [] ];
            this.unit = [ [1,1,1], [1,s,1], [s,s,1], [s,1,1], [s,1,s], [s,s,s], [1,s,s], [1,1,s], [1,1,1] ];
            this.xfrm = [ [1,0,0,0], [0,1,0,0], [0,0,1,0], [x,y,z,1] ];
            this.c = 0;
        }
        
        Cube.prototype.rotate = function(radX, radY, radZ){
            var tmpMatrix = [ [0,0,0,0], [0,0,0,0], [0,0,0,0], [0,0,0,0] ], 
                rotateMatrix = radX!=null? [ [1,0,0,0], [0,Math.cos(radX),Math.sin(radX),0], [0,-Math.sin(radX),Math.cos(radX),0], [0,0,0,1] ]
                             : radY!=null? [ [Math.cos(radY),0,-Math.sin(radY),0], [0,1,0,0], [Math.sin(radY),0,Math.cos(radY),0], [0,0,0,1] ]
                             : radZ!=null? [ [Math.cos(radZ),Math.sin(radZ),0,0], [-Math.sin(radZ),Math.cos(radZ),0,0], [0,0,1,0], [0,0,0,1] ]
                             : [ [1,0,0,0], [0,1,0,0], [0,0,1,0], [0,0,0,1] ];
            for(var i=0; i<this.xfrm.length; i++){ for(var j=0; j<this.xfrm.length; j++){ for(var k=0; k<this.xfrm.length; k++){
                tmpMatrix[i][j] += rotateMatrix[i][k] * this.xfrm[k][j];
            } } }
            this.xfrm = tmpMatrix;
        };
        
        Cube.prototype.transform = function(){
            this.rotate((Math.sin((++this.c)*0.01)/Math.PI),null,null);
            this.rotate(null,(Math.cos((++this.c)*0.01)/Math.PI),null);
            this.rotate(null,null,(Math.cos((++this.c)*0.01)/Math.PI));
            
            for(var r=0; r<this.obj.length; r++){ //construct current cubeMatrix from currentTransformation.
                this.obj[r][0] = (this.xfrm[0][0] * this.unit[r][0]) + (this.xfrm[1][0] * this.unit[r][1]) + (this.xfrm[2][0] * this.unit[r][2]) + this.xfrm[3][0];
                this.obj[r][1] = (this.xfrm[0][1] * this.unit[r][0]) + (this.xfrm[1][1] * this.unit[r][1]) + (this.xfrm[2][1] * this.unit[r][2]) + this.xfrm[3][1];
                this.obj[r][2] = (this.xfrm[0][2] * this.unit[r][0]) + (this.xfrm[1][2] * this.unit[r][1]) + (this.xfrm[2][2] * this.unit[r][2]) + this.xfrm[3][2];
            }
        }
        
        function init(){
            cube1 = new Cube(0, 0, 34);
            cube2 = new Cube(0, 10, 50);
        }
        
        function animate(){
            var x, y;
            
            cnv.width = cnv.width;
            ctx.strokeStyle = "#000000";
            ctx.beginPath();
            
            cube1.transform();
            
            for(var p=0; p<cube1.obj.length; p++){ //plot, projecting 3d to 2d
                x = Math.round(x0 + (cube1.obj[p][0] * pspctvX / cube1.obj[p][2]));
                y = Math.round(y0 - (cube1.obj[p][1] * pspctvY / cube1.obj[p][2]));
                ctx.lineTo(x,y);
            }
            ctx.stroke();
            
            t = setTimeout(function(){animate()}, 74);
        };
        
        if(window.addEventListener){
            window.addEventListener('load', init, false); 
            cnv.addEventListener('mouseover', animate, false); 
            cnv.addEventListener('mouseout', function(){clearTimeout(t);}, false); 
        }else if(window.attachEvent){ 
            window.attachEvent('onload', init);
            cnv.attachEvent('onmouseover', animate);
            cnv.attachEvent('onmouseout', function(){clearTimeout(t);});
        }
        
    </script>
</html>
